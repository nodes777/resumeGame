var platformer=function(){function e(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}function x(e,t,i){return Math.max(t,Math.min(i,e))}window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)});var c={tw:64,th:48},p=32,i=p,a=9.8*6,d=15,r=60,o=.5,l=1/6,h=1500,s={BLACK:"#111111",YELLOW:"#fffd98",GREEN:"#40a000",LIGHTGREEN:"#80e000",BROWN:"#c06000",DARKBROWN:"#602000",BLUE:"#0006FF",GOLD:"gold"},u=[s.YELLOW,s.GREEN,s.BLACK,s.BROWN,s.DARKBROWN],f=32,m=37,y=39,t=1/60,g=document.getElementById("canvas"),w=g.getContext("2d"),k=g.width=c.tw*p,v=g.height=c.th*p,L={},E=[],C=[],R=function(e){return e*p},W=function(e){return Math.floor(e/p)},B=function(e,t){return C[e+t*c.tw]},A=[],M={},O=document.getElementById("canvas").getBoundingClientRect(),Y=O.top+document.body.scrollTop,F=O.left+document.body.scrollLeft,H=[];function b(e){(e.classList.contains("hidden")||e.classList.contains("fadeOut"))&&(e.classList.remove("hidden"),e.classList.remove("fadeOut"),e.classList.add("fadeIn"))}function I(e,t){this.x=e,this.y=t,this.x_speed=Math.floor(10*Math.random()+1),this.y_speed=Math.floor(10*Math.random()+1),this.radius=5}function X(){if(A.length<100){var e=new I(100,200);A.push(e)}}function j(e,t,i){switch(t){case m:return L.left=i,e.preventDefault(),!1;case y:return L.right=i,e.preventDefault(),!1;case f:return L.jump=i,e.preventDefault(),!1}}function q(e){!function(e){!function(e,t){var i=e.dx<0,n=0<e.dx,c=e.falling,a=e.friction*(c?.5:1),d=e.accel*(c?.5:1);e.ddx=0,e.ddy=e.gravity,e.left?e.ddx=e.ddx-d:i&&(e.ddx=e.ddx+a);e.right?e.ddx=e.ddx+d:n&&(e.ddx=e.ddx-a);!e.jump||e.jumping||c||(e.ddy=e.ddy-e.impulse,e.jumping=!0);e.x=e.x+t*e.dx,e.y=e.y+t*e.dy,e.dx=x(e.dx+t*e.ddx,-e.maxdx,e.maxdx),e.dy=x(e.dy+t*e.ddy,-e.maxdy,e.maxdy),(i&&0<e.dx||n&&e.dx<0)&&(e.dx=0);var r=W(e.x),o=W(e.y),l=e.x%p,h=e.y%p,s=B(r,o),u=B(r+1,o),f=B(r,o+1),m=B(r+1,o+1);0<e.dy?(f&&!s||m&&!u&&l)&&(e.y=R(o),e.dy=0,e.falling=!1,e.jumping=!1,h=0):e.dy<0&&(s&&!f||u&&!m&&l)&&(e.y=R(o+1),e.dy=0,s=f,u=m,h=0);0<e.dx?(u&&!s||m&&!f&&h)&&(e.x=R(r),e.dx=0):e.dx<0&&(s&&!u||f&&!m&&h)&&(e.x=R(r+1),e.dx=0);e.falling=!(f||l&&m)}(L,e)}(e),function(e){for(n=0;n<E.length;n++){var t=(c=e.x,a=e.y,r=d=p,o=E[n].start.x,l=E[n].start.y,h=E[n].width,s=E[n].height,!(c+d-1<o||o+h-1<c||a+r-1<l||l+s-1<a));t&&(b(H[n]),4==n&&X(),H[n].focus()),t||!1!==E[n].clicked||(null!==(i=H[n])&&i.classList.contains("fadeIn")&&(i.classList.remove("fadeIn"),i.classList.add("fadeOut")),H[n]&&H[n].blur()),t||!0!==E[n].clicked||b(H[n])}var i;var c,a,d,r,o,l,h,s}(L),function(){for(var e=0;e<A.length;e++)A[e].x+=A[e].x_speed,A[e].y+=A[e].y_speed,(A[e].x>k||A[e].y>v)&&A.splice(e,1)}()}function N(e,t,i){e.clearRect(0,0,k,v),function(e,t){e.fillStyle=s.BLUE,e.fillRect(L.x+L.dx*t,L.y+L.dy*t,p,p)}(e,i),function(){for(var e=0;e<A.length;e++)A[e].render()}()}function S(){mapCache=document.getElementById("canvas2"),cachedContext=mapCache.getContext("2d"),mapCache.width=g.width,mapCache.height=g.height,function(e){var t,i,n;for(i=0;i<c.th;i++)for(t=0;t<c.tw;t++)(n=B(t,i))&&(e.fillStyle=u[n-1],e.fillRect(t*p,i*p,p,p))}(cachedContext),function(e){for(n=0;n<e.length;n++)cachedContext.font="40px Titillium Web",cachedContext.fillStyle=s.YELLOW,cachedContext.fillText(e[n].display,e[n].start.x,e[n].start.y+e[n].height-20)}(E),w.drawImage(mapCache,0,0)}g.addEventListener("click",function(e){var t=e.pageX-F,i=e.pageY-Y;M.x=t,M.y=i;for(var n=4,c=0;c<E.length;c++)M.y>E[c].clickY&&M.y<E[c].clickY+E[c].clickHeight&&M.x>E[c].clickX&&M.x<E[c].clickX+E[c].clickWidth?(b(H[c]),E[c].clicked=!0,E[n].clicked=!1,n=c):E[c].clicked=!1}),I.prototype.render=function(){w.beginPath(),w.arc(this.x,this.y,this.radius,2*Math.PI,!1),w.fillStyle="white",w.fill()};var T=window.innerWidth,D=window.innerHeight;function G(e){var t={};return t.name=e.name.charAt(0).toUpperCase()+e.name.slice(1),t.display=e.properties[0].value,1<e.properties.length&&(t.id=e.properties[1].value),t.clicked=!1,t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t.dx=0,t.dy=0,t.gravity=i*(e.properties.gravity||a),t.maxdx=i*(e.properties.maxdx||d),t.maxdy=i*(e.properties.maxdy||r),t.impulse=i*(e.properties.impulse||h),t.accel=t.maxdx/(e.properties.accel||o),t.friction=t.maxdx/(e.properties.friction||l),t.player="player"==e.type,t.left=e.properties.left,t.right=e.properties.right,t.start={x:e.x,y:e.y},t}var K,_,P,U,z=0,J=e();function Q(){for(fpsmeter.tickStart(),K=e(),z+=Math.min(1,(K-J)/1e3);t<z;)z-=t,q(t);N(w,0,z),J=K,0,fpsmeter.tick(),requestAnimationFrame(Q)}fpsmeter=new FPSMeter({decimals:0,graph:!0,theme:"dark",left:"5px"}),document.addEventListener("keydown",function(e){return j(e,e.keyCode,!0)},!1),document.addEventListener("keyup",function(e){return j(e,e.keyCode,!1)},!1),_="js/taylorMap10-15-2019.json",P=function(e){!function(e){var t,i,n,c=e.layers[0].data,a=e.layers[1].objects;for(t=0;t<a.length;t++)switch(n=G(i=a[t]),i.type){case"player":L=n;break;case"platform":E.push(n)}for(t=0;t<E.length;t++)H.push(document.getElementById(E[t].id));C=c;for(var d=2048/768,r=2048/896,o=0;o<E.length;o++)4!==o?T<=839||D<=529?(E[o].clickX=E[o].x/4,E[o].clickY=E[o].y/4,E[o].clickWidth=E[o].width/4,E[o].clickHeight=E[o].height/4):T<=967||D<=625?(E[o].clickX=E[o].x/3.2,E[o].clickY=E[o].y/3.2,E[o].clickWidth=E[o].width/3.2,E[o].clickHeight=E[o].height/3.2):T<=1095||D<=721?(E[o].clickX=E[o].x/d,E[o].clickY=E[o].y/d,E[o].clickWidth=E[o].width/d,E[o].clickHeight=E[o].height/d):T<=1223||D<=817?(E[o].clickX=E[o].x/r,E[o].clickY=E[o].y/r,E[o].clickWidth=E[o].width/r,E[o].clickHeight=E[o].height/r):(1223<T||817<D)&&(E[o].clickX=E[o].x/2,E[o].clickY=E[o].y/2,E[o].clickWidth=E[o].width/2,E[o].clickHeight=E[o].height/2):(E[o].clickX=null,E[o].clickY=null,E[o].clickWidth=null,E[o].clickHeight=null)}(JSON.parse(e.responseText)),S(),Q(),touchFile(L)},(U=new XMLHttpRequest).onreadystatechange=function(){4==U.readyState&&200==U.status&&P(U)},U.open("GET",_,!0),U.send()};platformer(),console.log("Hmmm, maybe try changing the background color to gray \n");