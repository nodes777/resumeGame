!function(e,t){function n(e,t){for(var n in t)try{e.style[n]=t[n]}catch(e){}return e}function o(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?Object.prototype.toString.call(e).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof e}function i(e,t){if("array"!==o(t))return-1;if(t.indexOf)return t.indexOf(e);for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1}function a(){var e,t=arguments;for(e in t[1])if(t[1].hasOwnProperty(e))switch(o(t[1][e])){case"object":t[0][e]=a({},t[0][e],t[1][e]);break;case"array":t[0][e]=t[1][e].slice(0);break;default:t[0][e]=t[1][e]}return 2<t.length?a.apply(null,[t[0]].concat(Array.prototype.slice.call(t,2))):t[0]}function r(e){return e=Math.round(255*e).toString(16),1===e.length?"0"+e:e}function c(e,t,n,o){e.addEventListener?e[o?"removeEventListener":"addEventListener"](t,n,!1):e.attachEvent&&e[o?"detachEvent":"attachEvent"]("on"+t,n)}function l(e,d){function p(e,t,n,o){return E[0|e][Math.round(Math.min((t-n)/(o-n)*D,D))]}function f(){j.legend.fps!==Y&&(j.legend.fps=Y,j.legend[g]=Y?"FPS":"ms"),T=Y?R.fps:R.duration,j.count[g]=999<T?"999+":T.toFixed(99<T?0:I.decimals)}function m(){for(O=s(),B<O-I.threshold&&(R.fps-=R.fps/Math.max(1,60*I.smoothing/I.interval),R.duration=1e3/R.fps),M=I.history;M--;)q[M]=0===M?R.fps:q[M-1],_[M]=0===M?R.duration:_[M-1];if(f(),I.heat){if(z.length)for(M=z.length;M--;)z[M].el.style[C[z[M].name].heatOn]=Y?p(C[z[M].name].heatmap,R.fps,0,I.maxFps):p(C[z[M].name].heatmap,R.duration,I.threshold,0);if(j.graph&&C.column.heatOn)for(M=H.length;M--;)H[M].style[C.column.heatOn]=Y?p(C.column.heatmap,q[M],0,I.maxFps):p(C.column.heatmap,_[M],I.threshold,0)}if(j.graph)for(A=0;A<I.history;A++)H[A].style.height=(Y?q[A]?Math.round(F/I.maxFps*Math.min(q[A],I.maxFps)):0:_[A]?Math.round(F/I.threshold*Math.min(_[A],I.threshold)):0)+"px"}function w(){20>I.interval?(L=u(w),m()):(L=setTimeout(w,I.interval),S=u(m))}function v(e){e=e||window.event,e.preventDefault?(e.preventDefault(),e.stopPropagation()):(e.returnValue=!1,e.cancelBubble=!0),R.toggle()}function b(){I.toggleOn&&c(j.container,I.toggleOn,v,1),e.removeChild(j.container)}function k(){if(j.container&&b(),C=l.theme[I.theme],E=C.compiledHeatmaps||[],!E.length&&C.heatmaps.length){for(A=0;A<C.heatmaps.length;A++)for(E[A]=[],M=0;M<=D;M++){var t,o=E[A],i=M;t=.33/D*M;var a=C.heatmaps[A].saturation,s=C.heatmaps[A].lightness,d=void 0,h=void 0,u=void 0,p=u=void 0,m=d=h=void 0,m=void 0,u=.5>=s?s*(1+a):s+a-s*a;0===u?t="#000":(p=2*s-u,h=(u-p)/u,t*=6,d=Math.floor(t),m=t-d,m*=u*h,0===d||6===d?(d=u,h=p+m,u=p):1===d?(d=u-m,h=u,u=p):2===d?(d=p,h=u,u=p+m):3===d?(d=p,h=u-m):4===d?(d=p+m,h=p):(d=u,h=p,u-=m),t="#"+r(d)+r(h)+r(u)),o[i]=t}C.compiledHeatmaps=E}j.container=n(document.createElement("div"),C.container),j.count=j.container.appendChild(n(document.createElement("div"),C.count)),j.legend=j.container.appendChild(n(document.createElement("div"),C.legend)),j.graph=I.graph?j.container.appendChild(n(document.createElement("div"),C.graph)):0,z.length=0;for(var g in j)j[g]&&C[g].heatOn&&z.push({name:g,el:j[g]});if(H.length=0,j.graph)for(j.graph.style.width=I.history*C.column.width+(I.history-1)*C.column.spacing+"px",M=0;M<I.history;M++)H[M]=j.graph.appendChild(n(document.createElement("div"),C.column)),H[M].style.position="absolute",H[M].style.bottom=0,H[M].style.right=M*C.column.width+M*C.column.spacing+"px",H[M].style.width=C.column.width+"px",H[M].style.height="0px";n(j.container,I),f(),e.appendChild(j.container),j.graph&&(F=j.graph.clientHeight),I.toggleOn&&("click"===I.toggleOn&&(j.container.style.cursor="pointer"),c(j.container,I.toggleOn,v))}"object"===o(e)&&e.nodeType===t&&(d=e,e=document.body),e||(e=document.body);var C,E,O,L,S,F,T,M,A,R=this,I=a({},l.defaults,d||{}),j={},H=[],D=100,z=[],N=0,P=I.threshold,W=0,B=s()-P,q=[],_=[],Y="fps"===I.show;R.options=I,R.fps=0,R.duration=0,R.isPaused=0,R.tickStart=function(){W=s()},R.tick=function(){O=s(),N=O-B,P+=(N-P)/I.smoothing,R.fps=1e3/P,R.duration=W<B?P:O-W,B=O},R.pause=function(){return L&&(R.isPaused=1,clearTimeout(L),h(L),h(S),L=S=0),R},R.resume=function(){return L||(R.isPaused=0,w()),R},R.set=function(e,t){return I[e]=t,Y="fps"===I.show,-1!==i(e,x)&&k(),-1!==i(e,y)&&n(j.container,I),R},R.showDuration=function(){return R.set("show","ms"),R},R.showFps=function(){return R.set("show","fps"),R},R.toggle=function(){return R.set("show",Y?"ms":"fps"),R},R.hide=function(){return R.pause(),j.container.style.display="none",R},R.show=function(){return R.resume(),j.container.style.display="block",R},R.destroy=function(){R.pause(),b(),R.tick=R.tickStart=function(){}},k(),w()}var s,d=e.performance;s=d&&(d.now||d.webkitNow)?d[d.now?"now":"webkitNow"].bind(d):function(){return+new Date};for(var h=e.cancelAnimationFrame||e.cancelRequestAnimationFrame,u=e.requestAnimationFrame,d=["moz","webkit","o"],p=0,f=0,m=d.length;f<m&&!h;++f)u=(h=e[d[f]+"CancelAnimationFrame"]||e[d[f]+"CancelRequestAnimationFrame"])&&e[d[f]+"RequestAnimationFrame"];h||(u=function(t){var n=s(),o=Math.max(0,16-(n-p));return p=n+o,e.setTimeout(function(){t(n+o)},o)},h=function(e){clearTimeout(e)});var g="string"===o(document.createElement("div").textContent)?"textContent":"innerText";l.extend=a,window.FPSMeter=l,l.defaults={interval:100,smoothing:10,show:"fps",toggleOn:"click",decimals:1,maxFps:60,threshold:100,position:"absolute",zIndex:10,left:"5px",top:"5px",right:"auto",bottom:"auto",margin:"0 0 0 0",theme:"dark",heat:0,graph:0,history:20};var x=["toggleOn","theme","heat","graph","history"],y="position zIndex left top right bottom margin".split(" ")}(window),function(e,t){t.theme={};var n=t.theme.base={heatmaps:[],container:{heatOn:null,heatmap:null,padding:"5px",minWidth:"95px",height:"30px",lineHeight:"30px",textAlign:"right",textShadow:"none"},count:{heatOn:null,heatmap:null,position:"absolute",top:0,right:0,padding:"5px 10px",height:"30px",fontSize:"24px",fontFamily:"Consolas, Andale Mono, monospace",zIndex:2},legend:{heatOn:null,heatmap:null,position:"absolute",top:0,left:0,padding:"5px 10px",height:"30px",fontSize:"12px",lineHeight:"32px",fontFamily:"sans-serif",textAlign:"left",zIndex:2},graph:{heatOn:null,heatmap:null,position:"relative",boxSizing:"padding-box",MozBoxSizing:"padding-box",height:"100%",zIndex:1},column:{width:4,spacing:1,heatOn:null,heatmap:null}};t.theme.dark=t.extend({},n,{heatmaps:[{saturation:.8,lightness:.8}],container:{background:"#222",color:"#fff",border:"1px solid #1a1a1a",textShadow:"1px 1px 0 #222"},count:{heatOn:"color"},column:{background:"#3f3f3f"}}),t.theme.light=t.extend({},n,{heatmaps:[{saturation:.5,lightness:.5}],container:{color:"#666",background:"#fff",textShadow:"1px 1px 0 rgba(255,255,255,.5), -1px -1px 0 rgba(255,255,255,.5)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},count:{heatOn:"color"},column:{background:"#eaeaea"}}),t.theme.colorful=t.extend({},n,{heatmaps:[{saturation:.5,lightness:.6}],container:{heatOn:"backgroundColor",background:"#888",color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.2)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},column:{background:"#777",backgroundColor:"rgba(0,0,0,.2)"}}),t.theme.transparent=t.extend({},n,{heatmaps:[{saturation:.8,lightness:.5}],container:{padding:0,color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.5)"},count:{padding:"0 5px",height:"40px",lineHeight:"40px"},legend:{padding:"0 5px",height:"40px",lineHeight:"42px"},graph:{height:"40px"},column:{width:5,background:"#999",heatOn:"backgroundColor",opacity:.5}})}(window,FPSMeter),!function(e,t,n){function o(e,t){return typeof e===t}function i(){var e,t,n,i,a,r,c;for(var l in d)if(d.hasOwnProperty(l)){if(e=[],t=d[l],t.name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length))for(n=0;n<t.options.aliases.length;n++)e.push(t.options.aliases[n].toLowerCase());for(i=o(t.fn,"function")?t.fn():t.fn,a=0;a<e.length;a++)r=e[a],c=r.split("."),1===c.length?u[c[0]]=i:(!u[c[0]]||u[c[0]]instanceof Boolean||(u[c[0]]=new Boolean(u[c[0]])),u[c[0]][c[1]]=i),s.push((i?"":"no-")+c.join("-"))}}function a(e){var t=p.className,n=u._config.classPrefix||"";if(f&&(t=t.baseVal),u._config.enableJSClass){var o=new RegExp("(^|\\s)"+n+"no-js(\\s|$)");t=t.replace(o,"$1"+n+"js$2")}u._config.enableClasses&&(t+=" "+n+e.join(" "+n),f?p.className.baseVal=t:p.className=t)}function r(){return"function"!=typeof t.createElement?t.createElement(arguments[0]):f?t.createElementNS.call(t,"http://www.w3.org/2000/svg",arguments[0]):t.createElement.apply(t,arguments)}function c(){var e=t.body;return e||(e=r(f?"svg":"body"),e.fake=!0),e}function l(e,n,o,i){var a,l,s,d,h="modernizr",u=r("div"),f=c();if(parseInt(o,10))for(;o--;)s=r("div"),s.id=i?i[o]:h+(o+1),u.appendChild(s);return a=r("style"),a.type="text/css",a.id="s"+h,(f.fake?f:u).appendChild(a),f.appendChild(u),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(t.createTextNode(e)),u.id=h,f.fake&&(f.style.background="",f.style.overflow="hidden",d=p.style.overflow,p.style.overflow="hidden",p.appendChild(f)),l=n(u,e),f.fake?(f.parentNode.removeChild(f),p.style.overflow=d,p.offsetHeight):u.parentNode.removeChild(u),!!l}var s=[],d=[],h={_version:"3.3.1",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var n=this;setTimeout(function(){t(n[e])},0)},addTest:function(e,t,n){d.push({name:e,fn:t,options:n})},addAsyncTest:function(e){d.push({name:null,fn:e})}},u=function(){};u.prototype=h,u=new u;var p=t.documentElement,f="svg"===p.nodeName.toLowerCase(),m=h._config.usePrefixes?" -webkit- -moz- -o- -ms- ".split(" "):["",""];h._prefixes=m;var g=h.testStyles=l;u.addTest("touchevents",function(){var n;if("ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch)n=!0;else{var o=["@media (",m.join("touch-enabled),("),"heartz",")","{#modernizr{top:9px;position:absolute}}"].join("");g(o,function(e){n=9===e.offsetTop})}return n}),i(),a(s),delete h.addTest,delete h.addAsyncTest;for(var x=0;x<u._q.length;x++)u._q[x]();e.Modernizr=u}(window,document);var platformer=function(){function e(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}function t(e,t,n){return Math.max(t,Math.min(n,e))}function o(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){4==n.readyState&&200==n.status&&t(n)},n.open("GET",e,!0),n.send()}function i(e,t,n,o,i,a,r,c){return!(e+n-1<i||i+r-1<e||t+o-1<a||a+c-1<t)}function a(e){(e.classList.contains("hidden")||e.classList.contains("fadeOut"))&&(e.classList.remove("hidden"),e.classList.remove("fadeOut"),e.classList.add("fadeIn"))}function r(e){e.classList.contains("fadeIn")&&(e.classList.remove("fadeIn"),e.classList.add("fadeOut"))}function c(e,t){this.x=e,this.y=t,this.x_speed=Math.floor(10*Math.random()+1),this.y_speed=Math.floor(10*Math.random()+1),this.radius=5}function l(){for(var e=0;e<U.length;e++)U[e].render()}function s(){for(var e=0;e<U.length;e++)U[e].x+=U[e].x_speed,U[e].y+=U[e].y_speed,(U[e].x>W||U[e].y>B)&&U.splice(e,1)}function d(){if(U.length<100){var e=new c(100,200);U.push(e)}}function h(e,t,n){switch(t){case H.LEFT:return q.left=n,e.preventDefault(),!1;case H.RIGHT:return q.right=n,e.preventDefault(),!1;case H.SPACE:return q.jump=n,e.preventDefault(),!1}}function u(e){p(e),m(q),s()}function p(e){f(q,e)}function f(e,n){var o=e.dx<0,i=e.dx>0,a=e.falling,r=e.friction*(a?.5:1),c=e.accel*(a?.5:1);e.ddx=0,e.ddy=e.gravity,e.left?e.ddx=e.ddx-c:o&&(e.ddx=e.ddx+r),e.right?e.ddx=e.ddx+c:i&&(e.ddx=e.ddx-r),!e.jump||e.jumping||a||(e.ddy=e.ddy-e.impulse,e.jumping=!0),e.x=e.x+n*e.dx,e.y=e.y+n*e.dy,e.dx=t(e.dx+n*e.ddx,-e.maxdx,e.maxdx),e.dy=t(e.dy+n*e.ddy,-e.maxdy,e.maxdy),(o&&e.dx>0||i&&e.dx<0)&&(e.dx=0);var l=X(e.x),s=X(e.y),d=e.x%O,h=e.y%O,u=G(l,s),p=G(l+1,s),f=G(l,s+1),m=G(l+1,s+1);e.dy>0?(f&&!u||m&&!p&&d)&&(e.y=$(s),e.dy=0,e.falling=!1,e.jumping=!1,h=0):e.dy<0&&(u&&!f||p&&!m&&d)&&(e.y=$(s+1),e.dy=0,u=f,p=m,h=0),e.dx>0?(p&&!u||m&&!f&&h)&&(e.x=$(l),e.dx=0):e.dx<0&&(u&&!p||f&&!m&&h)&&(e.x=$(l+1),e.dx=0),e.falling=!(f||d&&m)}function m(e){for(n=0;n<_.length;n++)i(e.x,e.y,O,O,_[n].start.x,_[n].start.y,_[n].width,_[n].height)&&(a(Z[n]),4==n&&d()),i(e.x,e.y,O,O,_[n].start.x,_[n].start.y,_[n].width,_[n].height)||_[n].clicked!==!1||r(Z[n]),i(e.x,e.y,O,O,_[n].start.x,_[n].start.y,_[n].width,_[n].height)||_[n].clicked!==!0||a(Z[n])}function g(e,t,n){e.clearRect(0,0,W,B),w(_),y(e,n),l()}function x(e){var t,n,o;for(n=0;n<E.th;n++)for(t=0;t<E.tw;t++)o=G(t,n),o&&(e.fillStyle=j[o-1],e.fillRect(t*O,n*O,O,O))}function y(e,t){e.fillStyle=I.BLUE,e.fillRect(q.x+q.dx*t,q.y+q.dy*t,O,O)}function w(e){for(n=0;n<e.length;n++)P.font="40px Titillium Web",P.fillStyle=I.YELLOW,P.fillText(e[n].display,e[n].start.x,e[n].start.y+e[n].height-20)}function v(){mapCache=document.getElementById("canvas2"),cachedContext=mapCache.getContext("2d"),mapCache.width=N.width,mapCache.height=N.height,x(cachedContext),P.drawImage(mapCache,0,0)}function b(e){var t,n,o,i=e.layers[0].data,a=e.layers[1].objects;for(t=0;t<a.length;t++)switch(n=a[t],o=k(n),n.type){case"player":q=o;break;case"platform":_.push(o)}for(t=0;t<_.length;t++)Z.push(document.getElementById(_[t].id));console.log(Z),Y=i;for(var r=4,c=3.2,l=2048/768,s=2048/896,d=2,h=0;h<_.length;h++)4!==h?te<=839||ne<=529?(_[h].clickX=_[h].x/r,_[h].clickY=_[h].y/r,_[h].clickWidth=_[h].width/r,_[h].clickHeight=_[h].height/r):te<=967||ne<=625?(_[h].clickX=_[h].x/c,_[h].clickY=_[h].y/c,_[h].clickWidth=_[h].width/c,_[h].clickHeight=_[h].height/c):te<=1095||ne<=721?(_[h].clickX=_[h].x/l,_[h].clickY=_[h].y/l,_[h].clickWidth=_[h].width/l,_[h].clickHeight=_[h].height/l):te<=1223||ne<=817?(_[h].clickX=_[h].x/s,_[h].clickY=_[h].y/s,_[h].clickWidth=_[h].width/s,_[h].clickHeight=_[h].height/s):(te>1223||ne>817)&&(_[h].clickX=_[h].x/d,_[h].clickY=_[h].y/d,_[h].clickWidth=_[h].width/d,_[h].clickHeight=_[h].height/d):(_[h].clickX=null,_[h].clickY=null,_[h].clickWidth=null,_[h].clickHeight=null)}function k(e){var t={};return t.name=e.name.charAt(0).toUpperCase()+e.name.slice(1),t.display=e.properties.display,t.id=e.properties.id,t.clicked=!1,t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t.dx=0,t.dy=0,t.gravity=L*(e.properties.gravity||S),t.maxdx=L*(e.properties.maxdx||F),t.maxdy=L*(e.properties.maxdy||T),t.impulse=L*(e.properties.impulse||R),t.accel=t.maxdx/(e.properties.accel||M),t.friction=t.maxdx/(e.properties.friction||A),t.player="player"==e.type,t.left=e.properties.left,t.right=e.properties.right,t.start={x:e.x,y:e.y},t}function C(){for(ee=e(),ie+=Math.min(1,(ee-ae)/1e3);ie>z;)ie-=z,u(z);g(P,oe,ie),ae=ee,oe++,requestAnimationFrame(C)}window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)});var E={tw:64,th:48},O=32,L=O,S=9.8*6,F=15,T=60,M=.5,A=1/6,R=1500,I={BLACK:"#111111",YELLOW:"#fffd98",GREEN:"#40a000",LIGHTGREEN:"#80e000",BROWN:"#c06000",DARKBROWN:"#602000",BLUE:"#0006FF",GOLD:"gold"},j=[I.YELLOW,I.GREEN,I.BLACK,I.BROWN,I.DARKBROWN],H={SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40},D=60,z=1/D,N=document.getElementById("canvas"),P=N.getContext("2d"),W=N.width=E.tw*O,B=N.height=E.th*O,q={},_=[],Y=[],$=function(e){return e*O},X=function(e){return Math.floor(e/O)},G=function(e,t){return Y[e+t*E.tw]},U=[],K={},J=document.getElementById("canvas").getBoundingClientRect(),V=J.top+document.body.scrollTop,Q=J.left+document.body.scrollLeft,Z=[];N.addEventListener("click",function(e){var t=e.pageX-Q,n=e.pageY-V;K.x=t,K.y=n;for(var o=4,i=0;i<_.length;i++)K.y>_[i].clickY&&K.y<_[i].clickY+_[i].clickHeight&&K.x>_[i].clickX&&K.x<_[i].clickX+_[i].clickWidth?(a(Z[i]),_[i].clicked=!0,_[o].clicked=!1,o=i):_[i].clicked=!1}),c.prototype.render=function(){P.beginPath(),P.arc(this.x,this.y,this.radius,2*Math.PI,!1),P.fillStyle="white",P.fill()};var ee,te=window.innerWidth,ne=window.innerHeight,oe=0,ie=0,ae=e();document.addEventListener("keydown",function(e){return h(e,e.keyCode,!0)},!1),document.addEventListener("keyup",function(e){return h(e,e.keyCode,!1)},!1),o("js/taylorMap.json",function(e){b(JSON.parse(e.responseText)),v(),C(),touchFile(q)})};platformer(),console.log("Hmmm, maybe try changing the background color to gray \n");var touchFile=function(e){Modernizr.touchevents?(console.log("Touch events enabled"),$(".instructions").hide(),$("#touchIconUp").bind("touchstart",function(t){t.preventDefault(),e.jump=!0}),$("#touchIconUp").bind("touchend",function(t){t.preventDefault(),e.jump=!1}),$("#touchIconLeft").bind("touchstart",function(t){t.preventDefault(),e.left=!0}),$("#touchIconLeft").bind("touchend",function(t){t.preventDefault(),e.left=!1}),$("#touchIconRight").bind("touchstart",function(t){t.preventDefault(),e.right=!0}),$("#touchIconRight").bind("touchend",function(t){t.preventDefault(),e.right=!1})):$(".touchies").hide()};