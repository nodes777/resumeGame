!function(o,A){function P(t,e){for(var n in e)try{t.style[n]=e[n]}catch(t){}return t}function H(t){return null==t?String(t):"object"==typeof t||"function"==typeof t?Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof t}function T(t,e){if("array"!==H(e))return-1;if(e.indexOf)return e.indexOf(t);for(var n=0,o=e.length;n<o;n++)if(e[n]===t)return n;return-1}function j(){var t,e=arguments;for(t in e[1])if(e[1].hasOwnProperty(t))switch(H(e[1][t])){case"object":e[0][t]=j({},e[0][t],e[1][t]);break;case"array":e[0][t]=e[1][t].slice(0);break;default:e[0][t]=e[1][t]}return 2<e.length?j.apply(null,[e[0]].concat(Array.prototype.slice.call(e,2))):e[0]}function I(t){return 1===(t=Math.round(255*t).toString(16)).length?"0"+t:t}function q(t,e,n,o){t.addEventListener?t[o?"removeEventListener":"addEventListener"](e,n,!1):t.attachEvent&&t[o?"detachEvent":"attachEvent"]("on"+e,n)}function D(p,t){function e(t,e,n,o){return f[0|t][Math.round(Math.min((e-n)/(o-n)*O,O))]}function u(){y.legend.fps!==E&&(y.legend.fps=E,y.legend[N]=E?"FPS":"ms"),l=E?c.fps:c.duration,y.count[N]=999<l?"999+":l.toFixed(99<l?0:v.decimals)}function n(){for(i=L(),C<i-v.threshold&&(c.fps-=c.fps/Math.max(1,60*v.smoothing/v.interval),c.duration=1e3/c.fps),b=v.history;b--;)M[b]=0===b?c.fps:M[b-1],z[b]=0===b?c.duration:z[b-1];if(u(),v.heat){if(S.length)for(b=S.length;b--;)S[b].el.style[m[S[b].name].heatOn]=E?e(m[S[b].name].heatmap,c.fps,0,v.maxFps):e(m[S[b].name].heatmap,c.duration,v.threshold,0);if(y.graph&&m.column.heatOn)for(b=k.length;b--;)k[b].style[m.column.heatOn]=E?e(m.column.heatmap,M[b],0,v.maxFps):e(m.column.heatmap,z[b],v.threshold,0)}if(y.graph)for(w=0;w<v.history;w++)k[w].style.height=(E?M[w]?Math.round(x/v.maxFps*Math.min(M[w],v.maxFps)):0:z[w]?Math.round(x/v.threshold*Math.min(z[w],v.threshold)):0)+"px"}function o(){v.interval<20?(r=B(o),n()):(r=setTimeout(o,v.interval),h=B(n))}function d(t){(t=t||window.event).preventDefault?(t.preventDefault(),t.stopPropagation()):(t.returnValue=!1,t.cancelBubble=!0),c.toggle()}function g(){v.toggleOn&&q(y.container,v.toggleOn,d,1),p.removeChild(y.container)}function a(){if(y.container&&g(),m=D.theme[v.theme],!(f=m.compiledHeatmaps||[]).length&&m.heatmaps.length){for(w=0;w<m.heatmaps.length;w++)for(f[w]=[],b=0;b<=O;b++){var t,e=f[w],n=b;t=.33/O*b;var o=m.heatmaps[w].saturation,a=m.heatmaps[w].lightness,i=void 0,r=void 0,h=void 0,l=h=void 0,c=i=r=void 0;c=void 0;t=0===(h=a<=.5?a*(1+o):a+o-a*o)?"#000":(r=(h-(l=2*a-h))/h,c=(t*=6)-(i=Math.floor(t)),c*=h*r,0===i||6===i?(i=h,r=l+c,h=l):1===i?(i=h-c,r=h,h=l):2===i?(r=h,h=(i=l)+c):3===i?(i=l,r=h-c):4===i?(i=l+c,r=l):(i=h,r=l,h-=c),"#"+I(i)+I(r)+I(h)),e[n]=t}m.compiledHeatmaps=f}for(var s in y.container=P(document.createElement("div"),m.container),y.count=y.container.appendChild(P(document.createElement("div"),m.count)),y.legend=y.container.appendChild(P(document.createElement("div"),m.legend)),y.graph=v.graph?y.container.appendChild(P(document.createElement("div"),m.graph)):0,S.length=0,y)y[s]&&m[s].heatOn&&S.push({name:s,el:y[s]});if(k.length=0,y.graph)for(y.graph.style.width=v.history*m.column.width+(v.history-1)*m.column.spacing+"px",b=0;b<v.history;b++)k[b]=y.graph.appendChild(P(document.createElement("div"),m.column)),k[b].style.position="absolute",k[b].style.bottom=0,k[b].style.right=b*m.column.width+b*m.column.spacing+"px",k[b].style.width=m.column.width+"px",k[b].style.height="0px";P(y.container,v),u(),p.appendChild(y.container),y.graph&&(x=y.graph.clientHeight),v.toggleOn&&("click"===v.toggleOn&&(y.container.style.cursor="pointer"),q(y.container,v.toggleOn,d))}"object"===H(p)&&p.nodeType===A&&(t=p,p=document.body),p=p||document.body;var m,f,i,r,h,x,l,b,w,c=this,v=j({},D.defaults,t||{}),y={},k=[],O=100,S=[],s=v.threshold,F=0,C=L()-s,M=[],z=[],E="fps"===v.show;c.options=v,c.fps=0,c.duration=0,c.isPaused=0,c.tickStart=function(){F=L()},c.tick=function(){i=L(),s+=(i-C-s)/v.smoothing,c.fps=1e3/s,c.duration=F<C?s:i-F,C=i},c.pause=function(){return r&&(c.isPaused=1,clearTimeout(r),R(r),R(h),r=h=0),c},c.resume=function(){return r||(c.isPaused=0,o()),c},c.set=function(t,e){return v[t]=e,E="fps"===v.show,-1!==T(t,V)&&a(),-1!==T(t,W)&&P(y.container,v),c},c.showDuration=function(){return c.set("show","ms"),c},c.showFps=function(){return c.set("show","fps"),c},c.toggle=function(){return c.set("show",E?"ms":"fps"),c},c.hide=function(){return c.pause(),y.container.style.display="none",c},c.show=function(){return c.resume(),y.container.style.display="block",c},c.destroy=function(){c.pause(),g(),c.tick=c.tickStart=function(){}},a(),o()}var L,t=o.performance;L=t&&(t.now||t.webkitNow)?t[t.now?"now":"webkitNow"].bind(t):function(){return+new Date};for(var R=o.cancelAnimationFrame||o.cancelRequestAnimationFrame,B=o.requestAnimationFrame,a=0,e=0,n=(t=["moz","webkit","o"]).length;e<n&&!R;++e)B=(R=o[t[e]+"CancelAnimationFrame"]||o[t[e]+"CancelRequestAnimationFrame"])&&o[t[e]+"RequestAnimationFrame"];R||(B=function(t){var e=L(),n=Math.max(0,16-(e-a));return a=e+n,o.setTimeout(function(){t(e+n)},n)},R=function(t){clearTimeout(t)});var N="string"===H(document.createElement("div").textContent)?"textContent":"innerText";D.extend=j,(window.FPSMeter=D).defaults={interval:100,smoothing:10,show:"fps",toggleOn:"click",decimals:1,maxFps:60,threshold:100,position:"absolute",zIndex:10,left:"5px",top:"5px",right:"auto",bottom:"auto",margin:"0 0 0 0",theme:"dark",heat:0,graph:0,history:20};var V=["toggleOn","theme","heat","graph","history"],W="position zIndex left top right bottom margin".split(" ")}(window),function(t,e){e.theme={};var n=e.theme.base={heatmaps:[],container:{heatOn:null,heatmap:null,padding:"5px",minWidth:"95px",height:"30px",lineHeight:"30px",textAlign:"right",textShadow:"none"},count:{heatOn:null,heatmap:null,position:"absolute",top:0,right:0,padding:"5px 10px",height:"30px",fontSize:"24px",fontFamily:"Consolas, Andale Mono, monospace",zIndex:2},legend:{heatOn:null,heatmap:null,position:"absolute",top:0,left:0,padding:"5px 10px",height:"30px",fontSize:"12px",lineHeight:"32px",fontFamily:"sans-serif",textAlign:"left",zIndex:2},graph:{heatOn:null,heatmap:null,position:"relative",boxSizing:"padding-box",MozBoxSizing:"padding-box",height:"100%",zIndex:1},column:{width:4,spacing:1,heatOn:null,heatmap:null}};e.theme.dark=e.extend({},n,{heatmaps:[{saturation:.8,lightness:.8}],container:{background:"#222",color:"#fff",border:"1px solid #1a1a1a",textShadow:"1px 1px 0 #222"},count:{heatOn:"color"},column:{background:"#3f3f3f"}}),e.theme.light=e.extend({},n,{heatmaps:[{saturation:.5,lightness:.5}],container:{color:"#666",background:"#fff",textShadow:"1px 1px 0 rgba(255,255,255,.5), -1px -1px 0 rgba(255,255,255,.5)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},count:{heatOn:"color"},column:{background:"#eaeaea"}}),e.theme.colorful=e.extend({},n,{heatmaps:[{saturation:.5,lightness:.6}],container:{heatOn:"backgroundColor",background:"#888",color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.2)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},column:{background:"#777",backgroundColor:"rgba(0,0,0,.2)"}}),e.theme.transparent=e.extend({},n,{heatmaps:[{saturation:.8,lightness:.5}],container:{padding:0,color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.5)"},count:{padding:"0 5px",height:"40px",lineHeight:"40px"},legend:{padding:"0 5px",height:"40px",lineHeight:"42px"},graph:{height:"40px"},column:{width:5,background:"#999",heatOn:"backgroundColor",opacity:.5}})}(window,FPSMeter);